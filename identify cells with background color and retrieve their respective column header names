import openpyxl
from openpyxl.styles import PatternFill

# Load the Excel file
workbook = openpyxl.load_workbook('your_excel_file.xlsx')
sheet = workbook.active  # Assuming you're working with the active sheet

# Define the RGB color you want to check
target_color = (172, 185, 130)

# Create a dictionary to store the column names
column_names = {}

# Loop through the rows and columns
for row in sheet.iter_rows(min_row=1, max_row=2):
    for cell in row:
        # Check if the cell color matches the target color
        if isinstance(cell.fill, PatternFill) and cell.fill.fgColor.rgb == target_color:
            # Get the column letter for the cell
            column_letter = openpyxl.utils.get_column_letter(cell.column)
            # Get the corresponding column name from the header row
            header_cell = sheet.cell(row=1, column=cell.column)
            column_name = header_cell.value
            # Store the column name in the dictionary
            column_names[column_letter] = column_name

# Print the column names for cells with the target color
for column_letter, column_name in column_names.items():
    print(f"Cell in column {column_letter} with color RGB{target_color} has the column name: {column_name}")
