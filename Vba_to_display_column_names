Sub ApplyConditionalFormattingToAllSheets2()
    Dim ws As Worksheet
    Dim rng As Range
    Dim formula As String
    formula = "=$A:$W"
    
    For Each ws In ThisWorkbook.Sheets
        Set rng = ws.Range(formula)
        
        rng.FormatConditions.Add Type:=xlUniqueValues
        With rng.FormatConditions(rng.FormatConditions.Count)
            .Interior.Color = RGB(172, 185, 130)
            .Font.Color = RGB(0, 0, 0)
        End With
        
        ' Extend the formatting to the row containing column headers (assumed to be in row 2)
        Dim headerRange As Range
        Set headerRange = ws.Range(ws.Cells(2, 1), ws.Cells(2, rng.Columns.Count))
        headerRange.FormatConditions.Add Type:=xlUniqueValues
        With headerRange.FormatConditions(headerRange.FormatConditions.Count)
            .Interior.Color = RGB(172, 185, 130)
            .Font.Color = RGB(0, 0, 0)
        End With
    Next ws
End Sub
