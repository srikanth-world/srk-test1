Sub HighlightUniqueValuesAndWriteColumnNames()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your sheet name

    ' Apply conditional formatting to highlight unique values
    ws.Range("A1").CurrentRegion.Select ' Assuming your data starts in A1
    Selection.FormatConditions.AddUniqueValues
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    Selection.FormatConditions(1).DupeUnique = xlDuplicate
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0
    End With

    ' Write column names in the second row at the end of the sheet
    Dim LastCol As Long
    LastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column
    Dim Col As Long
    For Col = 1 To LastCol
        ws.Cells(2, Col).Value = ws.Cells(1, Col).Value
    Next Col
End Sub
