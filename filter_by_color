import openpyxl

def check_filter_by_color(sheet):
    for column_index in range(1, sheet.max_column + 1):
        column_letter = openpyxl.utils.get_column_letter(column_index)
        cell = sheet[column_letter + '2']

        for rule in sheet.conditional_formatting.cf_rules:
            if rule.formula1 and column_letter in rule.formula1:
                print(f"Column {column_letter} supports filtering by color.")
                break

# Replace 'your_excel_file.xlsx' with the actual name of your Excel file
excel_file_path = 'your_excel_file.xlsx'

# Load the workbook
workbook = openpyxl.load_workbook(excel_file_path)

# Assume you want to check the first sheet, change the index if needed
sheet = workbook.worksheets[0]

# Check and print columns that support filtering by color
check_filter_by_color(sheet)

# Close the workbook
workbook.close()
