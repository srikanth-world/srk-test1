import pandas as pd
from openpyxl import load_workbook

# Load the Excel file
file_path = 'your_file.xlsx'
df = pd.read_excel(file_path, header=1)  # Assuming column names start from row 2

# Iterate through columns and check for color
colored_columns = []
for column in df.columns:
    if any(df[column].apply(lambda x: isinstance(x, pd._libs.tslibs.timestamps.Timestamp) and x.style.fill.bgColor.rgb != '00000000')):
        colored_columns.append(column)

print("Columns with colored cells:", colored_columns)
