from openpyxl import load_workbook

# Load the Excel file
file_path = 'your_file.xlsx'
wb = load_workbook(file_path)

# Assuming data is in the first sheet
sheet = wb.active

# Specify the row to check for colored cells
target_row = 1

# Find columns with colored cells in the specified row
colored_columns = []
for column in sheet.iter_cols(min_col=1, max_col=sheet.max_column, min_row=target_row, max_row=target_row):
    for cell in column:
        if cell.fill.start_color.index != '00000000':
            colored_columns.append(sheet.cell(row=1, column=cell.column).column_letter)

# Remove duplicates and sort the list
colored_columns = sorted(list(set(colored_columns)))

print("Columns with colored cells in row", target_row, ":", colored_columns)
